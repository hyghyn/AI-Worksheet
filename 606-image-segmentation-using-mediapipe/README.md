# Image Segmentation using MediaPipe

## ЁЯУЦ р╕Др╕│р╕нр╕Шр╕┤р╕Ър╕▓р╕вр╣Вр╕Ыр╕гр╣Ар╕Ир╕Д
р╣Вр╕Ыр╕гр╣Ар╕Ир╕Др╕Щр╕╡р╣Йр╣Гр╕Кр╣Й MediaPipe Image Segmentation р╕гр╣Ир╕зр╕бр╕Бр╕▒р╕Ър╣Вр╕бр╣Ар╕Фр╕е DeepLab v3 р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╣Бр╕Ър╣Ир╕Зр╕кр╣Ир╕зр╕Щр╕ар╕▓р╕Юр╣Бр╕Ър╕Ър╣Ар╕гр╕╡р╕вр╕ер╣Др╕Чр╕бр╣М р╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Бр╕вр╕Бр╕зр╕▒р╕Хр╕Цр╕╕р╕нр╕нр╕Бр╕Ир╕▓р╕Бр╕Юр╕╖р╣Йр╕Щр╕лр╕ер╕▒р╕Зр╣Бр╕ер╕░р╣Бр╕кр╕Фр╕Зр╕Ьр╕ер╣Ар╕Ыр╣Зр╕Щр╕бр╕▓р╕кр╕Бр╣Мр╕кр╕╡р╕Чр╕╡р╣Ир╕Хр╣Ир╕▓р╕Зр╕Бр╕▒р╕Щ

## тЬи р╕Яр╕╡р╣Ар╕Ир╕нр╕гр╣Мр╕лр╕ер╕▒р╕Б
- тЬЕ р╣Бр╕Ър╣Ир╕Зр╕кр╣Ир╕зр╕Щр╕ар╕▓р╕Юр╣Бр╕Ър╕Ър╣Ар╕гр╕╡р╕вр╕ер╣Др╕Чр╕бр╣Мр╕Ьр╣Ир╕▓р╕Щр╕Бр╕ер╣Йр╕нр╕Зр╣Ар╕зр╣Зр╕Ър╣Бр╕Др╕б
- тЬЕ р╣Бр╕вр╕Бр╕зр╕▒р╕Хр╕Цр╕╕р╕нр╕нр╕Бр╕Ир╕▓р╕Бр╕Юр╕╖р╣Йр╕Щр╕лр╕ер╕▒р╕З
- тЬЕ р╣Бр╕кр╕Фр╕Зр╕Ьр╕ер╣Ар╕Ыр╣Зр╕Щр╕бр╕▓р╕кр╕Бр╣Мр╕кр╕╡ (Foreground = р╕кр╕╡р╕Вр╕▓р╕з, Background = р╕кр╕╡р╣Ар╕Чр╕▓)
- тЬЕ р╣Бр╕кр╕Фр╕Зр╕ар╕▓р╕Юр╕Ир╕гр╕┤р╕Зр╣Бр╕ер╕░р╕ар╕▓р╕Юр╕Чр╕╡р╣Ир╣Бр╕Ър╣Ир╕Зр╕кр╣Ир╕зр╕Щр╕Юр╕гр╣Йр╕нр╕бр╕Бр╕▒р╕Щ
- тЬЕ р╣Гр╕Кр╣Йр╣Вр╕бр╣Ар╕Фр╕е DeepLab v3 р╕Чр╕╡р╣Ир╕бр╕╡р╕Др╕зр╕▓р╕бр╣Бр╕бр╣Ир╕Щр╕вр╕│р╕кр╕╣р╕З

## ЁЯЫая╕П р╣Ар╕Чр╕Др╣Вр╕Щр╣Вр╕еуВ╕р╕╡р╕Чр╕╡р╣Ир╣Гр╕Кр╣Й
- **OpenCV** - р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╕Ыр╕гр╕░р╕бр╕зр╕ер╕Ьр╕ер╕ар╕▓р╕Юр╣Бр╕ер╕░р╣Бр╕кр╕Фр╕Зр╕Ьр╕ер╕Ир╕▓р╕Бр╕Бр╕ер╣Йр╕нр╕З
- **MediaPipe** - р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╣Бр╕Ър╣Ир╕Зр╕кр╣Ир╕зр╕Щр╕ар╕▓р╕Ю
- **NumPy** - р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕ар╕▓р╕Ю
- **DeepLab v3** - р╣Вр╕бр╣Ар╕Фр╕е AI р╕кр╕│р╕лр╕гр╕▒р╕Ър╣Бр╕Ър╣Ир╕Зр╕кр╣Ир╕зр╕Щр╕ар╕▓р╕Ю

## ЁЯУж р╕Бр╕▓р╕гр╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З
```bash
pip install opencv-python mediapipe numpy
```

## ЁЯЪА р╕зр╕┤р╕Шр╕╡р╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ
1. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Гр╕лр╣Йр╣Бр╕Щр╣Ир╣Гр╕Ир╕зр╣Ир╕▓р╕бр╕╡р╣Др╕Яр╕ер╣Мр╣Вр╕бр╣Ар╕Фр╕ер╕нр╕вр╕╣р╣Ир╣Гр╕Щр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М:
   - `deeplab_v3.tflite`
   - `selfie_multiclass_256x256.tflite`
2. р╕гр╕▒р╕Щр╣Др╕Яр╕ер╣М `606.py`
3. р╕Бр╕ер╣Йр╕нр╕Зр╣Ар╕зр╣Зр╕Ър╣Бр╕Др╕бр╕Ир╕░р╣Ар╕Ыр╕┤р╕Фр╕Вр╕╢р╣Йр╕Щ
4. р╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕бр╕Ир╕░р╣Бр╕кр╕Фр╕З 2 р╕лр╕Щр╣Йр╕▓р╕Хр╣Ир╕▓р╕З:
   - р╕лр╕Щр╣Йр╕▓р╕Хр╣Ир╕▓р╕З "real" - р╣Бр╕кр╕Фр╕Зр╕ар╕▓р╕Юр╕Ир╕гр╕┤р╕Зр╕Ир╕▓р╕Бр╕Бр╕ер╣Йр╕нр╕З
   - р╕лр╕Щр╣Йр╕▓р╕Хр╣Ир╕▓р╕З "segment" - р╣Бр╕кр╕Фр╕Зр╕ар╕▓р╕Юр╕Чр╕╡р╣Ир╣Бр╕Ър╣Ир╕Зр╕кр╣Ир╕зр╕Щр╣Бр╕ер╣Йр╕з
5. р╕Бр╕Ф **ESC** р╣Ар╕Юр╕╖р╣Ир╕нр╕нр╕нр╕Бр╕Ир╕▓р╕Бр╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕б

## ЁЯУБ р╣Др╕Яр╕ер╣Мр╣Гр╕Щр╣Вр╕Ыр╕гр╣Ар╕Ир╕Д
- `606.py` - р╣Вр╕Др╣Йр╕Фр╕лр╕ер╕▒р╕Бр╕кр╕│р╕лр╕гр╕▒р╕Ър╣Бр╕Ър╣Ир╕Зр╕кр╣Ир╕зр╕Щр╕ар╕▓р╕Ю
- `deeplab_v3.tflite` - р╣Вр╕бр╣Ар╕Фр╕е DeepLab v3
- `selfie_multiclass_256x256.tflite` - р╣Вр╕бр╣Ар╕Фр╕ер╕кр╕│р╕лр╕гр╕▒р╕Ър╣Бр╕Ър╣Ир╕Зр╕кр╣Ир╕зр╕Щр╕ар╕▓р╕Юр╣Ар╕Лр╕ер╕Яр╕╡р╣И

## тЪЩя╕П р╕Бр╕▓р╕гр╕Ыр╕гр╕▒р╕Ър╣Бр╕Хр╣Ир╕З
р╕кр╕▓р╕бр╕▓р╕гр╕Цр╕Ыр╕гр╕▒р╕Ър╣Бр╕Хр╣Ир╕Зр╕кр╕╡р╣Др╕Фр╣Й:
- `BG_COLOR = (192, 192, 192)` - р╕кр╕╡р╕Юр╕╖р╣Йр╕Щр╕лр╕ер╕▒р╕З (р╣Ар╕Чр╕▓)
- `MASK_COLOR = (255, 255, 255)` - р╕кр╕╡р╕зр╕▒р╕Хр╕Цр╕╕ (р╕Вр╕▓р╕з)
- `condition` - р╣Ар╕Бр╕Ур╕Ср╣Мр╕Бр╕▓р╕гр╣Бр╕Ър╣Ир╕Зр╕кр╣Ир╕зр╕Щ (р╕Ыр╕▒р╕Ир╕Ир╕╕р╕Ър╕▒р╕Щр╕Хр╕▒р╣Йр╕Зр╕Чр╕╡р╣И > 0.2)

## ЁЯУЭ р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕
- р╣Вр╕бр╣Ар╕Фр╕е DeepLab v3 р╣Ар╕Ыр╣Зр╕Щр╣Вр╕бр╣Ар╕Фр╕ер╕Чр╕╡р╣Ир╕бр╕╡р╕Др╕зр╕▓р╕бр╣Бр╕бр╣Ир╕Щр╕вр╕│р╕кр╕╣р╕Зр╣Гр╕Щр╕Бр╕▓р╕гр╣Бр╕Ър╣Ир╕Зр╕кр╣Ир╕зр╕Щр╕ар╕▓р╕Ю
- р╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╣Вр╕бр╣Ар╕Фр╕ер╣Ар╕Ыр╣Зр╕Щ `selfie_multiclass_256x256.tflite` р╣Др╕Фр╣Йр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╣Бр╕Ър╣Ир╕Зр╕кр╣Ир╕зр╕Щр╕ар╕▓р╕Юр╣Ар╕Лр╕ер╕Яр╕╡р╣И
- р╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕бр╣Гр╕Кр╣Й Category Mask р╣Ар╕Юр╕╖р╣Ир╕нр╕гр╕░р╕Ър╕╕р╕кр╣Ир╕зр╕Щр╕Хр╣Ир╕▓р╕Зр╣Ж р╕Вр╕нр╕Зр╕ар╕▓р╕Ю
